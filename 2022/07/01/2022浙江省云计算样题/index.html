<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>2022浙江省云计算样题 | Misswjy&#39;Blog</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="2022年浙江省职业院校技能大赛高职组云计算竞赛赛卷（样卷）">
<meta property="og:type" content="article">
<meta property="og:title" content="2022浙江省云计算样题">
<meta property="og:url" content="http://example.com/2022/07/01/2022%E6%B5%99%E6%B1%9F%E7%9C%81%E4%BA%91%E8%AE%A1%E7%AE%97%E6%A0%B7%E9%A2%98/index.html">
<meta property="og:site_name" content="Misswjy&#39;Blog">
<meta property="og:description" content="2022年浙江省职业院校技能大赛高职组云计算竞赛赛卷（样卷）">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2022/07/01/2022%E6%B5%99%E6%B1%9F%E7%9C%81%E4%BA%91%E8%AE%A1%E7%AE%97%E6%A0%B7%E9%A2%98/clip_image002.gif">
<meta property="article:published_time" content="2022-07-01T04:00:27.000Z">
<meta property="article:modified_time" content="2022-07-02T12:21:16.000Z">
<meta property="article:author" content="Miss">
<meta property="article:tag" content="云计算">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/07/01/2022%E6%B5%99%E6%B1%9F%E7%9C%81%E4%BA%91%E8%AE%A1%E7%AE%97%E6%A0%B7%E9%A2%98/clip_image002.gif">
  
    <link rel="alternative" href="/atom.xml" title="Misswjy&#39;Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 6.1.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
				<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
			<h1 class="header-author"><a href="/">Miss</a></h1>
		</hgroup>

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="half-header-menu">
						<a class="hide">Home</a>
						<a>Tags</a>
						<a>Links</a>
						<a>About</a>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/Misswjy" title="github">github</a>
					        
								<a class="mail" target="_blank" href="/dockery@foxmail.com" title="mail">mail</a>
					        
								<a class="bilibili" target="_blank" href="https://space.bilibili.com/292671654" title="bilibili">bilibili</a>
					        
						</div>
						<!-- music -->
						
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/k8s/" style="font-size: 15px;">k8s</a> <a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" style="font-size: 12.5px;">云计算</a> <a href="/tags/%E5%AE%B9%E5%99%A8%E4%BA%91/" style="font-size: 17.5px;">容器云</a> <a href="/tags/%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2%E5%92%8C%E8%BF%90%E7%BB%B4/" style="font-size: 10px;">应用部署和运维</a> <a href="/tags/%E7%A7%81%E6%9C%89%E4%BA%91/" style="font-size: 20px;">私有云</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/">github</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">I&#39;m a developer.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Misswjy" title="github">github</a>
			        
						<a class="mail" target="_blank" href="/dockery@foxmail.com" title="mail">mail</a>
			        
						<a class="bilibili" target="_blank" href="https://space.bilibili.com/292671654" title="bilibili">bilibili</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-2022浙江省云计算样题" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/07/01/2022%E6%B5%99%E6%B1%9F%E7%9C%81%E4%BA%91%E8%AE%A1%E7%AE%97%E6%A0%B7%E9%A2%98/" class="article-date">
  	<time datetime="2022-07-01T04:00:27.000Z" itemprop="datePublished">2022-07-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      2022浙江省云计算样题
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" rel="tag">云计算</a></li></ul>
	</div>

        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="2022年浙江省职业院校技能大赛高职组云计算竞赛赛卷（样卷）"><a href="#2022年浙江省职业院校技能大赛高职组云计算竞赛赛卷（样卷）" class="headerlink" title="2022年浙江省职业院校技能大赛高职组云计算竞赛赛卷（样卷）"></a>2022年浙江省职业院校技能大赛高职组云计算竞赛赛卷（样卷）<span id="more"></span></h1><p>【任务1】基础运维任务[5分]</p>
<p>【题目1】基础环境配置</p>
<p>根据表1中的IP地址规划，设置各服务器节点的IP地址，确保网络正常通信，然后按以下要求配置服务器：</p>
<p>（1）设置控制节点主机名为controller，设置计算节点主机名为compute；</p>
<p><strong>controller:</strong></p>
<p><code>hostnamectl set-hostname controller</code></p>
<p><code>bash</code></p>
<p><strong>compute:</strong></p>
<p><code>hostnamectl set-hostname compute</code></p>
<p><code>bash</code></p>
<p>（2）修改hosts文件将IP地址映射为主机名；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# cat /etc/hosts</span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line"></span><br><span class="line">192.168.20.113 controller</span><br><span class="line">192.168.20.120 compute</span><br></pre></td></tr></table></figure>

<p>（3）关闭控制节点的防火墙，设置开机不启动；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# systemctl stop firewalld</span><br><span class="line"></span><br><span class="line">[root@controller ~]# systemctl disable firewalld</span><br></pre></td></tr></table></figure>

<p>（4）设置SELinux为Permissive 模式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# cat /etc/selinux/config </span><br><span class="line"></span><br><span class="line"># This file controls the state of SELinux on the system.</span><br><span class="line"></span><br><span class="line"># SELINUX=permissive</span><br><span class="line"></span><br><span class="line">#     enforcing - SELinux security policy is enforced.</span><br><span class="line"></span><br><span class="line">#     permissive - SELinux prints warnings instead of enforcing.</span><br><span class="line"></span><br><span class="line">#     disabled - No SELinux policy is loaded.</span><br><span class="line"></span><br><span class="line">SELINUX=permissive</span><br><span class="line"></span><br><span class="line"># SELINUXTYPE= can take one of three two values:</span><br><span class="line"></span><br><span class="line">#     targeted - Targeted processes are protected,</span><br><span class="line"></span><br><span class="line">#     minimum - Modification of targeted policy. Only selected processes are protected. </span><br><span class="line"></span><br><span class="line">#     mls - Multi Level Security protection.</span><br><span class="line"></span><br><span class="line">SELINUXTYPE=targeted</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# setenforce 0</span><br><span class="line">setenforce: SELinux is disabled</span><br></pre></td></tr></table></figure>

<p>【题目2】镜像挂载</p>
<p>将提供的CentOS-7-x86_64-DVD-1804.iso和chinaskill_cloud_iaas.iso光盘镜像上传到controller节点&#x2F;root目录下，然后在&#x2F;opt目录下分别创建centos目录和openstack目录，并将镜像文件CentOS-7-x86_64-DVD-1804.iso挂载到centos目录下，将镜像文件chinaskill_cloud_iaas.iso挂载到openstack目录下。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<p><strong>略</strong></p>
<p>【题目3】Yum源配置</p>
<p>在controller节点上利用&#x2F;opt&#x2F;centos目录中的软件包安装vsftpd服务，设置开机自启动，并使用ftp提供yum仓库服务（ftp共享的目录为&#x2F;opt），分别设置controller节点和compute节点的yum源文件ftp.repo，其中ftp服务器地址使用主机名形式。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<p><strong>略</strong></p>
<p>【题目4】时间同步配置</p>
<p>在controller节点上部署chrony服务器，允许其他节点同步时间，启动服务并设置为开机启动；在compute节点上指定controller节点为上游NTP服务器，重启服务并设为开机启动。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<blockquote>
<p>这里可以先下载iaas-xiandian</p>
</blockquote>
<p><code>yum install -y iaas-xiandian</code></p>
<p><strong>然后编辑变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# cat /etc/xiandian/openrc.sh </span><br><span class="line">#--------------------system Config--------------------##</span><br><span class="line">#Controller Server Manager IP. example:x.x.x.x</span><br><span class="line">HOST_IP=192.168.20.113</span><br><span class="line"></span><br><span class="line">#Controller HOST Password. example:000000 </span><br><span class="line">HOST_PASS=000000</span><br><span class="line"></span><br><span class="line">#Controller Server hostname. example:controller</span><br><span class="line">HOST_NAME=controller</span><br><span class="line"></span><br><span class="line">#Compute Node Manager IP. example:x.x.x.x</span><br><span class="line">HOST_IP_NODE=192.168.20.120</span><br><span class="line"></span><br><span class="line">#Compute HOST Password. example:000000 </span><br><span class="line">HOST_PASS_NODE=000000</span><br><span class="line"></span><br><span class="line">#Compute Node hostname. example:compute</span><br><span class="line">HOST_NAME_NODE=compute</span><br><span class="line"></span><br><span class="line">#--------------------Chrony Config-------------------##</span><br><span class="line">#Controller network segment IP.  example:x.x.0.0/16(x.x.x.0/24)</span><br><span class="line">network_segment_IP=192.168.20.0/24</span><br><span class="line"></span><br><span class="line">#--------------------Rabbit Config ------------------##</span><br><span class="line">#user for rabbit. example:openstack</span><br><span class="line">RABBIT_USER=openstack</span><br><span class="line"></span><br><span class="line">#Password for rabbit user .example:000000</span><br><span class="line">RABBIT_PASS=000000</span><br><span class="line"></span><br><span class="line">#--------------------MySQL Config---------------------##</span><br><span class="line">#Password for MySQL root user . exmaple:000000</span><br><span class="line">DB_PASS=000000</span><br><span class="line"></span><br><span class="line">#--------------------Keystone Config------------------##</span><br><span class="line">#Password for Keystore admin user. exmaple:000000</span><br><span class="line">DOMAIN_NAME=demo</span><br><span class="line">ADMIN_PASS=000000</span><br><span class="line">DEMO_PASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Mysql keystore user. exmaple:000000</span><br><span class="line">KEYSTONE_DBPASS=000000</span><br><span class="line"></span><br><span class="line">#--------------------Glance Config--------------------##</span><br><span class="line">#Password for Mysql glance user. exmaple:000000</span><br><span class="line">GLANCE_DBPASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Keystore glance user. exmaple:000000</span><br><span class="line">GLANCE_PASS=000000</span><br><span class="line"></span><br><span class="line">#--------------------Nova Config----------------------##</span><br><span class="line">#Password for Mysql nova user. exmaple:000000</span><br><span class="line">NOVA_DBPASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Keystore nova user. exmaple:000000</span><br><span class="line">NOVA_PASS=000000</span><br><span class="line"></span><br><span class="line">#--------------------Neturon Config-------------------##</span><br><span class="line">#Password for Mysql neutron user. exmaple:000000</span><br><span class="line">NEUTRON_DBPASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Keystore neutron user. exmaple:000000</span><br><span class="line">NEUTRON_PASS=000000</span><br><span class="line"></span><br><span class="line">#metadata secret for neutron. exmaple:000000</span><br><span class="line">METADATA_SECRET=000000</span><br><span class="line"></span><br><span class="line">#Tunnel Network Interface. example:x.x.x.x</span><br><span class="line">INTERFACE_IP=192.168.20.113 #注意这里是哪个节点就用哪个的ip</span><br><span class="line"></span><br><span class="line">#External Network Interface. example:eth1</span><br><span class="line">INTERFACE_NAME=eth1</span><br><span class="line"></span><br><span class="line">#External Network The Physical Adapter. example:provider</span><br><span class="line">Physical_NAME=provider</span><br><span class="line"></span><br><span class="line">#First Vlan ID in VLAN RANGE for VLAN Network. exmaple:101</span><br><span class="line">minvlan=101</span><br><span class="line"></span><br><span class="line">#Last Vlan ID in VLAN RANGE for VLAN Network. example:200</span><br><span class="line">maxvlan=200</span><br><span class="line"></span><br><span class="line">#--------------------Cinder Config--------------------##</span><br><span class="line">#Password for Mysql cinder user. exmaple:000000</span><br><span class="line">CINDER_DBPASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Keystore cinder user. exmaple:000000</span><br><span class="line">CINDER_PASS=000000</span><br><span class="line"></span><br><span class="line">#Cinder Block Disk. example:md126p3</span><br><span class="line">BLOCK_DISK=vdb1</span><br><span class="line"></span><br><span class="line">#--------------------Swift Config---------------------##</span><br><span class="line">#Password for Keystore swift user. exmaple:000000</span><br><span class="line">SWIFT_PASS=000000</span><br><span class="line"></span><br><span class="line">#The NODE Object Disk for Swift. example:md126p4.</span><br><span class="line">OBJECT_DISK=vdb2</span><br><span class="line"></span><br><span class="line">#The NODE IP for Swift Storage Network. example:x.x.x.x.</span><br><span class="line">STORAGE_LOCAL_NET_IP=192.168.20.120</span><br><span class="line"></span><br><span class="line">#--------------------Heat Config----------------------##</span><br><span class="line">#Password for Mysql heat user. exmaple:000000</span><br><span class="line">HEAT_DBPASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Keystore heat user. exmaple:000000</span><br><span class="line">HEAT_PASS=000000</span><br><span class="line"></span><br><span class="line">#--------------------Zun Config-----------------------##</span><br><span class="line">#Password for Mysql Zun user. exmaple:000000</span><br><span class="line">ZUN_DBPASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Keystore Zun user. exmaple:000000</span><br><span class="line">ZUN_PASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Mysql Kuryr user. exmaple:000000</span><br><span class="line">KURYR_DBPASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Keystore Kuryr user. exmaple:000000</span><br><span class="line">KURYR_PASS=000000</span><br><span class="line"></span><br><span class="line">#--------------------Ceilometer Config----------------##</span><br><span class="line">#Password for Gnocchi ceilometer user. exmaple:000000</span><br><span class="line">CEILOMETER_DBPASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Keystore ceilometer user. exmaple:000000</span><br><span class="line">CEILOMETER_PASS=000000</span><br><span class="line"></span><br><span class="line">#--------------------AODH Config----------------##</span><br><span class="line">#Password for Mysql AODH user. exmaple:000000</span><br><span class="line">AODH_DBPASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Keystore AODH user. exmaple:000000</span><br><span class="line">AODH_PASS=000000</span><br><span class="line"></span><br><span class="line">#--------------------Barbican Config----------------##</span><br><span class="line">#Password for Mysql Barbican user. exmaple:000000</span><br><span class="line">BARBICAN_DBPASS=000000</span><br><span class="line"></span><br><span class="line">#Password for Keystore Barbican user. exmaple:000000</span><br><span class="line">BARBICAN_PASS=000000</span><br></pre></td></tr></table></figure>

<p><strong>执行脚本</strong></p>
<p><code>iaas-pre-host.sh</code></p>
<blockquote>
<p>注意两个节点都要执行</p>
</blockquote>
<p>【题目5】计算节点分区</p>
<p>在compute节点上利用空白分区划分2个100G分区。完成后提交计算节点的用户名、密码和IP地址到答题框。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[root@compute ~]# umount /dev/vdb</span><br><span class="line"></span><br><span class="line">[root@compute ~]# fdisk /dev/vdb</span><br><span class="line">Welcome to fdisk (util-linux 2.23.2).</span><br><span class="line"></span><br><span class="line">Changes will remain in memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write command.</span><br><span class="line"></span><br><span class="line">Command (m for help): n</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (0 primary, 0 extended, 4 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p): p</span><br><span class="line">Using default response p</span><br><span class="line">Partition number (1-4, default 1): 1</span><br><span class="line">First sector (2048-125829119, default 2048): </span><br><span class="line">Using default value 2048</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G&#125; (2048-125829119, default 125829119): +20G</span><br><span class="line">Partition 1 of type Linux and of size 20 GiB is set</span><br><span class="line"></span><br><span class="line">Command (m for help): n</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (1 primary, 0 extended, 3 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p): p</span><br><span class="line">Partition number (2-4, default 2): 2</span><br><span class="line">First sector (41945088-125829119, default 41945088): </span><br><span class="line">Using default value 41945088</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G&#125; (41945088-125829119, default 125829119): +20G</span><br><span class="line">Partition 2 of type Linux and of size 20 GiB is set</span><br><span class="line"></span><br><span class="line">Command (m for help): w</span><br><span class="line">The partition table has been altered!</span><br><span class="line"></span><br><span class="line">Calling ioctl() to re-read partition table.</span><br></pre></td></tr></table></figure>

<p>【任务2】OpenStack搭建任务[15分]</p>
<p>【适用平台】私有云</p>
<p>【题目1】基础安装</p>
<p>在控制节点和计算节点上分别安装iaas-xiandian软件包，根据表2配置两个节点脚本文件中的基本变量（配置脚本文件为&#x2F;etc&#x2F;xiandian&#x2F;openrc.sh）。</p>
<p>表2 云平台配置信息</p>
<table>
<thead>
<tr>
<th>服务名称</th>
<th>变量</th>
<th>参数&#x2F;密码</th>
</tr>
</thead>
<tbody><tr>
<td>Mysql</td>
<td>root</td>
<td>000000</td>
</tr>
<tr>
<td>Keystone</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Glance</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Nova</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Neutron</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Heat</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Zun</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Keystone</td>
<td>DOMAIN_NAME</td>
<td>demo</td>
</tr>
<tr>
<td>Admin</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Rabbit</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Glance</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Nova</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Neutron</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Heat</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Zun</td>
<td>000000</td>
<td></td>
</tr>
<tr>
<td>Neutron</td>
<td>Metadata</td>
<td>000000</td>
</tr>
<tr>
<td>External  Network</td>
<td>enp9s0（外网卡名）</td>
<td></td>
</tr>
</tbody></table>
<p>完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<p><strong>这里我们在配置时间同步时已经完成了</strong></p>
<p>【题目2】数据库安装</p>
<p>在controller节点上使用iaas-install-mysql.sh 脚本安装Mariadb、Memcached、etcd服务。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-mysql.sh </span><br></pre></td></tr></table></figure>

<p>【题目3】Keystone服务安装</p>
<p>在controller节点上使用iaas-install-keystone.sh 脚本安装Keystone服务。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-keystone.sh </span><br></pre></td></tr></table></figure>

<p>【题目4】Glance安装</p>
<p>在controller节点上使用iaas-install-glance.sh脚本安装glance 服务。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-glance.sh </span><br></pre></td></tr></table></figure>

<p>【题目5】Nova安装</p>
<p>在controller节点和compute节点上分别使用iaas-install-nova -controller.sh脚本、iaas-install-nova-compute.sh脚本安装Nova 服务。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<p><strong>controller</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-nova-controller.sh </span><br></pre></td></tr></table></figure>

<p><strong>compute:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@compute ~]# iaas-install-nova-compute.sh </span><br></pre></td></tr></table></figure>

<p>【题目6】Neutron安装</p>
<p>在controller节点和compute节点上分别修改iaas-install-neutron-controller.sh脚本、iaas-install-neutron-compute.sh脚本分别安装 Neutron 服务，执行完脚本后，网络默认是vlan模式。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# vi /usr/local/bin/iaas-install-neutron-controller.sh </span><br><span class="line"></span><br><span class="line">tenant_network_types  vxlan #将vxlan改为vlan</span><br></pre></td></tr></table></figure>

<p><strong>controller：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-neutron-controller.sh </span><br></pre></td></tr></table></figure>

<p><strong>compute：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@compute ~]# iaas-install-neutron-compute.sh </span><br></pre></td></tr></table></figure>

<p>【题目7】Doshboard安装</p>
<p>在controller节点上使用iaas-install-dashboad.sh脚本安装dashboad服务。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# iaas-install-dashboard.sh </span><br></pre></td></tr></table></figure>

<p>【题目8】Cinder安装</p>
<p>在控制节点和计算节点上分别使用iaas-install-cinder-controller.sh.sh脚本和iaas-install-cinder-compute.sh安装cinder服务。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<p><strong>controller</strong> </p>
<p><code>iaas-install-cinder-controller.sh</code></p>
<p><strong>compute</strong> </p>
<p><code>iaas-install-cinder-compute.sh</code></p>
<p>【任务3】OpenStack运维任务[15分]</p>
<p>【适用平台】私有云</p>
<p>【题目1】镜像管理</p>
<p>在openstack私有云平台上，基于cirros-0.3.4-x86_64-disk.img镜像，使用命令创建一个名为cirros的镜像。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack image create cirros --disk qcow2 --container bare &lt; cirros-0.3.4-x86_64-disk.img </span><br><span class="line">+------------------+------------------------------------------------------+</span><br><span class="line">| Field            | Value                                                |</span><br><span class="line">+------------------+------------------------------------------------------+</span><br><span class="line">| checksum         | ee1eca47dc88f4879d8a229cc70a07c6                     |</span><br><span class="line">| container_format | bare                                                 |</span><br><span class="line">| created_at       | 2022-07-01T06:04:17Z                                 |</span><br><span class="line">| disk_format      | qcow2                                                |</span><br><span class="line">| file             | /v2/images/ace27239-b0e1-4ed5-a303-aee306ff5477/file |</span><br><span class="line">| id               | ace27239-b0e1-4ed5-a303-aee306ff5477                 |</span><br><span class="line">| min_disk         | 0                                                    |</span><br><span class="line">| min_ram          | 0                                                    |</span><br><span class="line">| name             | cirros                                               |</span><br><span class="line">| owner            | 94e98329acc846e38579a511d0bc82a8                     |</span><br><span class="line">| protected        | False                                                |</span><br><span class="line">| schema           | /v2/schemas/image                                    |</span><br><span class="line">| size             | 13287936                                             |</span><br><span class="line">| status           | active                                               |</span><br><span class="line">| tags             |                                                      |</span><br><span class="line">| updated_at       | 2022-07-01T06:04:18Z                                 |</span><br><span class="line">| virtual_size     | None                                                 |</span><br><span class="line">| visibility       | shared                                               |</span><br><span class="line">+------------------+------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<p>【题目2】实例类型管理</p>
<p>在openstack私有云平台上，使用命令创建一个名为Fmin，ID为1，内存为1024 MB，磁盘为10 GB，vcpu数量为1的云主机类型。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack flavor create Fmid --id 1 --disk 10 --ram 1024 --vcpus 1</span><br><span class="line">+----------------------------+-------+</span><br><span class="line">| Field                      | Value |</span><br><span class="line">+----------------------------+-------+</span><br><span class="line">| OS-FLV-DISABLED:disabled   | False |</span><br><span class="line">| OS-FLV-EXT-DATA:ephemeral  | 0     |</span><br><span class="line">| disk                       | 10    |</span><br><span class="line">| id                         | 1     |</span><br><span class="line">| name                       | Fmid  |</span><br><span class="line">| os-flavor-access:is_public | True  |</span><br><span class="line">| properties                 |       |</span><br><span class="line">| ram                        | 1024  |</span><br><span class="line">| rxtx_factor                | 1.0   |</span><br><span class="line">| swap                       |       |</span><br><span class="line">| vcpus                      | 1     |</span><br><span class="line">+----------------------------+-------+</span><br></pre></td></tr></table></figure>

<p>【题目3】网络管理</p>
<p>在openstack私有云平台上，创建云主机网络extnet，子网extsubnet，虚拟机网段为192.168.y.0&#x2F;24（其中y是vlan号），网关为192.168.y.1。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack network create extnet --share --external --provider-physical-network provider --provider-network-type vlan</span><br><span class="line">+---------------------------+--------------------------------------+</span><br><span class="line">| Field                     | Value                                |</span><br><span class="line">+---------------------------+--------------------------------------+</span><br><span class="line">| admin_state_up            | UP                                   |</span><br><span class="line">| availability_zone_hints   |                                      |</span><br><span class="line">| availability_zones        |                                      |</span><br><span class="line">| created_at                | 2022-07-01T06:06:11Z                 |</span><br><span class="line">| description               |                                      |</span><br><span class="line">| dns_domain                | None                                 |</span><br><span class="line">| id                        | 1e7b526c-fe6f-491e-bebd-5125b34c8f0d |</span><br><span class="line">| ipv4_address_scope        | None                                 |</span><br><span class="line">| ipv6_address_scope        | None                                 |</span><br><span class="line">| is_default                | False                                |</span><br><span class="line">| is_vlan_transparent       | None                                 |</span><br><span class="line">| mtu                       | 1500                                 |</span><br><span class="line">| name                      | extnet                               |</span><br><span class="line">| port_security_enabled     | True                                 |</span><br><span class="line">| project_id                | 94e98329acc846e38579a511d0bc82a8     |</span><br><span class="line">| provider:network_type     | vlan                                 |</span><br><span class="line">| provider:physical_network | provider                             |</span><br><span class="line">| provider:segmentation_id  | 126                                  |</span><br><span class="line">| qos_policy_id             | None                                 |</span><br><span class="line">| revision_number           | 5                                    |</span><br><span class="line">| router:external           | External                             |</span><br><span class="line">| segments                  | None                                 |</span><br><span class="line">| shared                    | True                                 |</span><br><span class="line">| status                    | ACTIVE                               |</span><br><span class="line">| subnets                   |                                      |</span><br><span class="line">| tags                      |                                      |</span><br><span class="line">| updated_at                | 2022-07-01T06:06:12Z                 |</span><br><span class="line">+---------------------------+--------------------------------------+</span><br><span class="line">[root@controller ~]# openstack subnet create extsubnet --network extnet --subnet-range 192.168.23.0/24 --gateway 192.168.23.1</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| Field             | Value                                |</span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| allocation_pools  | 192.168.23.2-192.168.23.254          |</span><br><span class="line">| cidr              | 192.168.23.0/24                      |</span><br><span class="line">| created_at        | 2022-07-01T06:07:25Z                 |</span><br><span class="line">| description       |                                      |</span><br><span class="line">| dns_nameservers   |                                      |</span><br><span class="line">| enable_dhcp       | True                                 |</span><br><span class="line">| gateway_ip        | 192.168.23.1                         |</span><br><span class="line">| host_routes       |                                      |</span><br><span class="line">| id                | 730bd899-2daf-4395-a6a4-03fdbe7054f6 |</span><br><span class="line">| ip_version        | 4                                    |</span><br><span class="line">| ipv6_address_mode | None                                 |</span><br><span class="line">| ipv6_ra_mode      | None                                 |</span><br><span class="line">| name              | extsubnet                            |</span><br><span class="line">| network_id        | 1e7b526c-fe6f-491e-bebd-5125b34c8f0d |</span><br><span class="line">| project_id        | 94e98329acc846e38579a511d0bc82a8     |</span><br><span class="line">| revision_number   | 0                                    |</span><br><span class="line">| segment_id        | None                                 |</span><br><span class="line">| service_types     |                                      |</span><br><span class="line">| subnetpool_id     | None                                 |</span><br><span class="line">| tags              |                                      |</span><br><span class="line">| updated_at        | 2022-07-01T06:07:25Z                 |</span><br><span class="line">+-------------------+--------------------------------------+</span><br></pre></td></tr></table></figure>

<p>【题目4】云主机管理</p>
<p>在openstack私有云平台上，基于“cirros”镜像、flavor使用“Fmin”、extnet的网络，创建一台虚拟机VM1，启动VM1，并使用PC机能远程登录到VM1。提交控制节点的用户名、密码和IP地址到答题框。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# openstack server create VM1 --flavor Fmid --image cirros --network extnet</span><br><span class="line">+-------------------------------------+-----------------------------------------------+</span><br><span class="line">| Field                               | Value                                         |</span><br><span class="line">+-------------------------------------+-----------------------------------------------+</span><br><span class="line">| OS-DCF:diskConfig                   | MANUAL                                        |</span><br><span class="line">| OS-EXT-AZ:availability_zone         |                                               |</span><br><span class="line">| OS-EXT-SRV-ATTR:host                | None                                          |</span><br><span class="line">| OS-EXT-SRV-ATTR:hypervisor_hostname | None                                          |</span><br><span class="line">| OS-EXT-SRV-ATTR:instance_name       |                                               |</span><br><span class="line">| OS-EXT-STS:power_state              | NOSTATE                                       |</span><br><span class="line">| OS-EXT-STS:task_state               | scheduling                                    |</span><br><span class="line">| OS-EXT-STS:vm_state                 | building                                      |</span><br><span class="line">| OS-SRV-USG:launched_at              | None                                          |</span><br><span class="line">| OS-SRV-USG:terminated_at            | None                                          |</span><br><span class="line">| accessIPv4                          |                                               |</span><br><span class="line">| accessIPv6                          |                                               |</span><br><span class="line">| addresses                           |                                               |</span><br><span class="line">| adminPass                           | e6ARiS6VGc2x                                  |</span><br><span class="line">| config_drive                        |                                               |</span><br><span class="line">| created                             | 2022-07-01T21:51:24Z                          |</span><br><span class="line">| flavor                              | Fmid (1)                                      |</span><br><span class="line">| hostId                              |                                               |</span><br><span class="line">| id                                  | f36b7a73-8d87-413c-a9ac-440903c82aa0          |</span><br><span class="line">| image                               | cirros (ace27239-b0e1-4ed5-a303-aee306ff5477) |</span><br><span class="line">| key_name                            | None                                          |</span><br><span class="line">| name                                | VM1                                           |</span><br><span class="line">| progress                            | 0                                             |</span><br><span class="line">| project_id                          | 94e98329acc846e38579a511d0bc82a8              |</span><br><span class="line">| properties                          |                                               |</span><br><span class="line">| security_groups                     | name=&#x27;default&#x27;                                |</span><br><span class="line">| status                              | BUILD                                         |</span><br><span class="line">| updated                             | 2022-07-01T21:51:24Z                          |</span><br><span class="line">| user_id                             | e754b15e87104c81ad3554dc3bc64e25              |</span><br><span class="line">| volumes_attached                    |                                               |</span><br><span class="line">+-------------------------------------+-----------------------------------------------+</span><br></pre></td></tr></table></figure>

<p>【题目5】Cinder管理</p>
<p>在openstack私有云平台上，创建一个名为“lvm”的卷类型，创建一块卷设备，名字为block、类型为lvm的40G云硬盘，并附加到虚拟机VM1上。完成后提交控制节点IP地址、用户名和密码到答题框。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">[root@controller ~]# cinder type-create  lvm</span><br><span class="line">+--------------------------------------+------+-------------+-----------+</span><br><span class="line">| ID                                   | Name | Description | Is_Public |</span><br><span class="line">+--------------------------------------+------+-------------+-----------+</span><br><span class="line">| 7ef26956-bb5e-425d-9630-65d91ea2db4b | lvm  | -           | True      |</span><br><span class="line">+--------------------------------------+------+-------------+-----------+</span><br><span class="line"></span><br><span class="line">[root@controller ~]# cinder create --name block 10 --volume-type lvm</span><br><span class="line">+--------------------------------+--------------------------------------+</span><br><span class="line">| Property                       | Value                                |</span><br><span class="line">+--------------------------------+--------------------------------------+</span><br><span class="line">| attachments                    | []                                   |</span><br><span class="line">| availability_zone              | nova                                 |</span><br><span class="line">| bootable                       | false                                |</span><br><span class="line">| consistencygroup_id            | None                                 |</span><br><span class="line">| created_at                     | 2022-05-09T03:28:56.000000           |</span><br><span class="line">| description                    | None                                 |</span><br><span class="line">| encrypted                      | False                                |</span><br><span class="line">| id                             | 1dd10e41-f0c6-4feb-a7e8-ddb1d99b067f |</span><br><span class="line">| metadata                       | &#123;&#125;                                   |</span><br><span class="line">| migration_status               | None                                 |</span><br><span class="line">| multiattach                    | False                                |</span><br><span class="line">| name                           | block                                |</span><br><span class="line">| os-vol-host-attr:host          | None                                 |</span><br><span class="line">| os-vol-mig-status-attr:migstat | None                                 |</span><br><span class="line">| os-vol-mig-status-attr:name_id | None                                 |</span><br><span class="line">| os-vol-tenant-attr:tenant_id   | 0047a899f1b34aaba102c89bf5dbeab4     |</span><br><span class="line">| replication_status             | None                                 |</span><br><span class="line">| size                           | 1                                    |</span><br><span class="line">| snapshot_id                    | None                                 |</span><br><span class="line">| source_volid                   | None                                 |</span><br><span class="line">| status                         | creating                             |</span><br><span class="line">| updated_at                     | None                                 |</span><br><span class="line">| user_id                        | 73ba03dfca0f4de6953a79e478cd035f     |</span><br><span class="line">| volume_type                    | lvm                                 |</span><br><span class="line">+--------------------------------+--------------------------------------+</span><br><span class="line">[root@controller ~]# openstack server add volume vm1 block</span><br></pre></td></tr></table></figure>

<p>【题目6】Raid管理</p>
<p>在OpenStack私有云平台，创建一台云主机，并创建一个40G大小的cinder块存储，将块存储连接到云主机，然后在云主机上对云硬盘进行操作。要求分出4个大小为5G的分区，使用这4个分区，创建名为&#x2F;dev&#x2F;md5、raid级别为5的磁盘阵列加一个热备盘（使用最后一个分区作为热备盘）。完成后提交云主机的用户名、密码和IP地址到答题框。</p>
<p><code>yum install -y mdadm</code></p>
<p><code>umount /mnt</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">[root@raid ~]# fdisk /dev/vdb</span><br><span class="line">Welcome to fdisk (util-linux 2.23.2).</span><br><span class="line">Changes will remain in memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write command.</span><br><span class="line">Command (m for help): n</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (0 primary, 0 extended, 4 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p): </span><br><span class="line">Using default response p</span><br><span class="line">Partition number (1-4, default 1): </span><br><span class="line">First sector (2048-104857599, default 2048): </span><br><span class="line">Using default value 2048</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G&#125; (2048-104857599, default 104857599): +5G</span><br><span class="line">Partition 1 of type Linux and of size 5 GiB is set</span><br><span class="line">Command (m for help): n</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (1 primary, 0 extended, 3 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p): </span><br><span class="line">Using default response p</span><br><span class="line">Partition number (2-4, default 2): </span><br><span class="line">First sector (10487808-104857599, default 10487808): </span><br><span class="line">Using default value 10487808</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G&#125; (10487808-104857599, default 104857599): +5G</span><br><span class="line">Partition 2 of type Linux and of size 5 GiB is set</span><br><span class="line">Command (m for help): n</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (2 primary, 0 extended, 2 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p): </span><br><span class="line">Using default response p</span><br><span class="line">Partition number (3,4, default 3): </span><br><span class="line">First sector (20973568-104857599, default 20973568): </span><br><span class="line">Using default value 20973568</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G&#125; (20973568-104857599, default 104857599): +5G  </span><br><span class="line">Partition 3 of type Linux and of size 5 GiB is set</span><br><span class="line">Command (m for help): n</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (3 primary, 0 extended, 1 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default e): p</span><br><span class="line">Selected partition 4</span><br><span class="line">First sector (31459328-104857599, default 31459328): </span><br><span class="line">Using default value 31459328</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G&#125; (31459328-104857599, default 104857599): +5G</span><br><span class="line">Partition 4 of type Linux and of size 5 GiB is set</span><br><span class="line">Command (m for help): t</span><br><span class="line">Partition number (1-4, default 4): 1</span><br><span class="line">Hex code (type L to list all codes): fd</span><br><span class="line">Changed type of partition &#x27;Linux&#x27; to &#x27;Linux raid autodetect&#x27;</span><br><span class="line">Command (m for help): t</span><br><span class="line">Partition number (1-4, default 4): 2</span><br><span class="line">Hex code (type L to list all codes): fd</span><br><span class="line">Changed type of partition &#x27;Linux&#x27; to &#x27;Linux raid autodetect&#x27;</span><br><span class="line">Command (m for help): t</span><br><span class="line">Partition number (1-4, default 4): 3</span><br><span class="line">Hex code (type L to list all codes): fd</span><br><span class="line">Changed type of partition &#x27;Linux&#x27; to &#x27;Linux raid autodetect&#x27;</span><br><span class="line">Command (m for help): t</span><br><span class="line">Partition number (1-4, default 4): 4</span><br><span class="line">Hex code (type L to list all codes): fd</span><br><span class="line">Changed type of partition &#x27;Linux&#x27; to &#x27;Linux raid autodetect&#x27;</span><br><span class="line">Command (m for help): w</span><br><span class="line">The partition table has been altered!</span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line">Syncing disks.</span><br></pre></td></tr></table></figure>

<p><code>mdadm -C /dev/md5 -l 5 -n 3 -x 1 /dev/vdb1 /dev/vdb2 /dev/vdb3 /dev/vdb4</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@raid ~]# mdadm -D /dev/md5 </span><br><span class="line">/dev/md5:</span><br><span class="line">           Version : 1.2</span><br><span class="line">     Creation Time : Fri Apr 22 07:34:32 2022</span><br><span class="line">        Raid Level : raid5</span><br><span class="line">        Array Size : 10475520 (9.99 GiB 10.73 GB)</span><br><span class="line">     Used Dev Size : 5237760 (5.00 GiB 5.36 GB)</span><br><span class="line">      Raid Devices : 3</span><br><span class="line">     Total Devices : 4</span><br><span class="line">       Persistence : Superblock is persistent</span><br><span class="line">   Update Time : Fri Apr 22 07:40:00 2022</span><br><span class="line">         State : clean </span><br><span class="line">Active Devices : 3</span><br><span class="line">   Working Devices : 4</span><br><span class="line">    Failed Devices : 0</span><br><span class="line">     Spare Devices : 1</span><br><span class="line">        Layout : left-symmetric</span><br><span class="line">    Chunk Size : 512K</span><br><span class="line">Consistency Policy : resync</span><br><span class="line">          Name : raid.novalocal:5  (local to host raid.novalocal)</span><br><span class="line">          UUID : a7ee7f6c:33942c54:654cf6c9:880cc731</span><br><span class="line">        Events : 20</span><br><span class="line">Number   Major   Minor   RaidDevice State</span><br><span class="line">   0     253       17        0      active sync   /dev/vdb1</span><br><span class="line">   1     253       18        1      active sync   /dev/vdb2</span><br><span class="line">   4     253       19        2      active sync   /dev/vdb3</span><br><span class="line">   3     253       20        -      spare   /dev/vdb4</span><br></pre></td></tr></table></figure>

<p>【题目7】数据库主从管理</p>
<p>使用OpenStack私有云平台，创建两台云主机vm1和vm2，在这两台云主机上分别安装数据库服务，并配置成主从数据库，vm1节点为主库，vm2节点为从库（数据库密码设置为000000）。完成后提交数据库从节点vm2节点的用户名、密码和IP地址到答题框。</p>
<p><strong>（1）修改主机名</strong></p>
<p><strong>mysql1</strong></p>
<p><code>hostnamectl set-hostname mysql1</code></p>
<p><code>bash</code></p>
<p><code>exit</code></p>
<p><strong>mysql2</strong></p>
<p><code>hostnamectl set-hostname mysql2</code></p>
<p><code>bash</code></p>
<p><code>exit</code></p>
<p><strong>（2）配置hosts文件</strong></p>
<p>两个节点配置&#x2F;etc&#x2F;hosts文件，修改为如下</p>
<p><code>vi /etc/hosts</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">192.168.20.107  mysql1</span><br><span class="line">192.168.20.109  mysql2</span><br><span class="line">192.168.20.137  mycat</span><br></pre></td></tr></table></figure>

<p><strong>（3）配置YUM源</strong></p>
<p>两个节点均使用提供的mariadb–10.3.23-repo.tar.gz的压缩包，解压并放在&#x2F;opt目录下，进入&#x2F;etc&#x2F;yum.repos.d目录下，将原来的repo文件移除，新建local.repo文件并编辑内容，具体操作命令如下：</p>
<p><code>curl -O http://172.19.25.11/mariadb-10.3.23-repo.tar.gz</code></p>
<p> <code>tar -zxvf mariadb-10.3.23-repo.tar.gz -C /opt</code></p>
<p><code>rm -rf /etc/yum.repos.d/*</code></p>
<p><code>vi /etc/yum.repos.d/local.repo</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[mariadb]</span><br><span class="line">name=mariadb</span><br><span class="line">baseurl=file:///opt/</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br></pre></td></tr></table></figure>

<p><strong>（4）安装数据库服务并启动</strong></p>
<p>配置完毕后，两个节点安装数据库服务，命令如下：</p>
<p><code>yum install -y mariadb mariadb-server</code></p>
<p><code>systemctl start mariadb</code></p>
<p><code>systemctl enable mariadb</code></p>
<p><strong>(5）初始化数据库</strong></p>
<p>两个节点初始化数据库，配置数据库root密码为000000，命令如下：</p>
<p><code>mysql_secure_installation</code> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/mysql_secure_installation: line 379: find_mysql_client: command not found</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB</span><br><span class="line"></span><br><span class="line">   SERVERS IN PRODUCTION USE! PLEASE READ EACH STEP CAREFULLY!</span><br><span class="line"></span><br><span class="line">In order to log into MariaDB to secure it, we&#x27;ll need the current</span><br><span class="line">password for the root user. If you&#x27;ve just installed MariaDB, and</span><br><span class="line">you haven&#x27;t set the root password yet, the password will be blank,</span><br><span class="line">so you should just press enter here.</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Enter current password for root (enter for none):     #默认按Enter键</span><br><span class="line">OK, successfully used password, moving on...</span><br><span class="line"></span><br><span class="line">Setting the root password ensures that nobody can log into the MariaDB</span><br><span class="line">root user without the proper authorisation.</span><br><span class="line"></span><br><span class="line">Set root password? [Y/n] y</span><br><span class="line"></span><br><span class="line">New password:                 #输入数据库root密码000000</span><br><span class="line">Re-enter new password:             #再次输入密码000000</span><br><span class="line">Password updated successfully!</span><br><span class="line">Reloading privilege tables..</span><br><span class="line"> ... Success!</span><br><span class="line"></span><br><span class="line">By default, a MariaDB installation has an anonymous user, allowing anyone</span><br><span class="line">to log into MariaDB without having to have a user account created for</span><br><span class="line">them. This is intended only for testing, and to make the installation</span><br><span class="line">go a bit smoother. You should remove them before moving into a</span><br><span class="line">production environment.</span><br><span class="line"></span><br><span class="line">Remove anonymous users? [Y/n] y</span><br><span class="line"> ... Success!</span><br><span class="line"> </span><br><span class="line">Normally, root should only be allowed to connect from &#x27;localhost&#x27;. This</span><br><span class="line">ensures that someone cannot guess at the root password from the network.</span><br><span class="line"> </span><br><span class="line">Disallow root login remotely? [Y/n] n</span><br><span class="line"> ... skipping.</span><br><span class="line"></span><br><span class="line">By default, MariaDB comes with a database named &#x27;test&#x27; that anyone can</span><br><span class="line">access. This is also intended only for testing, and should be removed</span><br><span class="line">before moving into a production environment.</span><br><span class="line"></span><br><span class="line">Remove test database and access to it? [Y/n] y</span><br><span class="line"> \- Dropping test database...</span><br><span class="line"> ... Success!</span><br><span class="line"> \- Removing privileges on test database...</span><br><span class="line"> ... Success!</span><br><span class="line"></span><br><span class="line">Reloading the privilege tables will ensure that all changes made so far</span><br><span class="line">will take effect immediately.</span><br><span class="line"></span><br><span class="line">Reload privilege tables now? [Y/n] y</span><br><span class="line"> ... Success!</span><br><span class="line"> </span><br><span class="line">Cleaning up...</span><br><span class="line"></span><br><span class="line">All done! If you&#x27;ve completed all of the above steps, your MariaDB</span><br><span class="line">installation should now be secure.</span><br><span class="line"></span><br><span class="line">Thanks for using MariaDB!</span><br></pre></td></tr></table></figure>

<p><strong>（6）配置mysql1主节点</strong></p>
<p>修改mysql1节点的数据库配置文件，在配置文件&#x2F;etc&#x2F;my.cnf.d&#x2F;server.cnf中的[mysqld]增添如下内容。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@mysql1 ~]# cat /etc/my.cnf.d/server.cnf</span><br><span class="line">... ...</span><br><span class="line">[mysqld]</span><br><span class="line">log_bin = mysql-bin            #记录操作日志</span><br><span class="line">binlog_ignore_db = mysql         #不同步MySQL系统数据库</span><br><span class="line">server_id = 12              #数据库集群中的每个节点id都要不同，一般使用IP地址的最后段的数字，例如172.30.11.12，server_id就写12</span><br></pre></td></tr></table></figure>

<p>重启数据库服务，并进入数据库，命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@mysql1 ~]# systemctl restart mariadb</span><br><span class="line">[root@mysql1 ~]# mysql -uroot -p000000</span><br><span class="line">Welcome to the MariaDB monitor. Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 9</span><br><span class="line">Server version: 10.3.23-MariaDB-log MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span><br><span class="line"> </span><br><span class="line">MariaDB [(none)]&gt; </span><br></pre></td></tr></table></figure>

<p>在mysql1节点，授权在任何客户端机器上可以以root用户登录到数据库，然后在主节点上创建一个user用户连接节点mysql2，并赋予从节点同步主节点数据库的权限。命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; grant all privileges on *.* to root@&#x27;%&#x27; identified by &quot;000000&quot;;</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; grant replication slave on *.* to &#x27;user&#x27;@&#x27;mysql2&#x27; identified by &#x27;000000&#x27;;</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>（7）配置mysql2从节点</strong></p>
<p>修改mysql2节点的数据库配置文件，在配置文件&#x2F;etc&#x2F;my.cnf.d&#x2F;server.cnf中的[mysqld]增添如下内容。</p>
<p><code>[root@mysql2 ~]# cat /etc/my.cnf.d/server.cnf</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">... ...</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">log_bin = mysql-bin            #记录操作日志</span><br><span class="line">binlog_ignore_db = mysql         #不同步MySQL系统数据库</span><br><span class="line">server_id = 13              #数据库集群中的每个节点id都要不同，一般使用IP地址的最后段的数字，例如172.30.11.13，server_id就写13</span><br><span class="line"></span><br><span class="line">... ...</span><br></pre></td></tr></table></figure>

<p>修改完配置文件后，重启数据库服务，并在从节点mysql2上登录MariaDB数据库，配置从节点连接主节点的连接信息。master_host为主节点主机名mysql1，master_user为上一步中创建的用户user，命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@mysql2 ~]# systemctl restart mariadb</span><br><span class="line">[root@mysql2 ~]# mysql -uroot -p000000</span><br><span class="line">Welcome to the MariaDB monitor. Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 9</span><br><span class="line">Server version: 10.3.23-MariaDB-log MariaDB Server</span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; change master to master_host=&#x27;mysql1&#x27;,master_user=&#x27;user&#x27;,master_password=&#x27;000000&#x27;;</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>

<p>配置完毕主从数据库之间的连接信息之后，开启从节点服务。使用show slave status\G命令，并查看从节点服务状态，如果Slave_IO_Running和Slave_SQL_Running的状态都为YES，则从节点服务开启成功。命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; start slave;</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show slave status\G</span><br><span class="line"></span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">        Slave_IO_State: Waiting for master to send event</span><br><span class="line">          Master_Host: mysql1</span><br><span class="line">          Master_User: user</span><br><span class="line">         Master_Port: 3306</span><br><span class="line">         Connect_Retry: 60</span><br><span class="line">........</span><br><span class="line">      Slave_IO_Running: Yes</span><br><span class="line">       Slave_SQL_Running: Yes</span><br><span class="line">.........</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以看到Slave_IO_Running和Slave_SQL_Running的状态都是Yes，配置数据库主从集群成功。</p>
<p>【题目8】云平台安全策略提升</p>
<p>使用OpenStack私有云平台，通过提供的相关软件包，安装必要组件，将私有云平台的访问策略从http提升至https。完成后提交控制节点的用户名、密码和IP地址到答题框。</p>
<p><code>yum -y install mod_ssl</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/openstack-dashboard/local_settings</span><br><span class="line">##在DEBUG = False下增加4行</span><br><span class="line">USE_SSL = True</span><br><span class="line">CSRF_COOKIE_SECURE = True                              ##原文中有，去掉注释即可</span><br><span class="line">SESSION_COOKIE_SECURE = True                       ##原文中有，去掉注释即可</span><br><span class="line">SESSION_COOKIE_HTTPONLY = True</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/httpd/conf.d/ssl.conf</span><br><span class="line">##将SSLProtocol all -SSLv2 -SSLv3改成：</span><br><span class="line">SSLProtocol all -SSLv2</span><br></pre></td></tr></table></figure>

<p> <code>systemctl restart httpd</code></p>
<p><code>systemctl restart memcached</code></p>
<p>【任务4】OpenStack运维开发任务[15分]</p>
<p>【适用平台】私有云</p>
<p>本任务只公布考试范围，不公布赛题</p>
<p>此任务包含2-4个子任务，内容涉及编写Python脚本调用OpenStack API对Openstack云平台进行管理和运维。使用自动化运维工具ansible对云主机进行批量系统配置、批量程序部署、批量运行命令等运维操作。</p>
<p>【任务5】Docker CE及私有仓库安装任务（5分）</p>
<p>【适用平台】私有云</p>
<p>【题目1】安装Docker CE和Docker Compose</p>
<p>在master、node各节点中分别安装DockerCE和docker-compose。完成后提交master节点的用户名、密码和IP到答题框。</p>
<p>脚本安装</p>
<p>【题目2】安装私有仓库</p>
<p>脚本安装</p>
<p>【题目3】容器编排</p>
<p>在master节点上编写&#x2F;root&#x2F;wordpress&#x2F;docker-compose.yaml文件，具体要求如下：</p>
<p>（1）容器名称：wordpress；镜像：wordpress:latest；端口映射：82:80；</p>
<p>（2）容器名称：mysql；镜像：mysql:5.6； </p>
<p>（3）MySQL root用户密码：123456；</p>
<p>（4）创建数据库wordpress。</p>
<p>完成后编排部署WordPress，并提交master节点的用户名、密码和IP到答题框。</p>
<p> <code>cd /root</code></p>
<p><code>vi docker-compose.yaml</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">version: &#x27;3.3&#x27;</span><br><span class="line">services:</span><br><span class="line">   mysql:</span><br><span class="line">     image: mysql:5.6</span><br><span class="line">     restart: always</span><br><span class="line">     environment:</span><br><span class="line">       MYSQL_ROOT_PASSWORD: 123456</span><br><span class="line">       MYSQL_DATABASE: wordpress</span><br><span class="line">       MYSQL_USER: wordpress</span><br><span class="line">       MYSQL_PASSWORD: wordpress</span><br><span class="line">   wordpress:</span><br><span class="line">     depends_on:</span><br><span class="line">       - mysql</span><br><span class="line">     image: wordpress:latest</span><br><span class="line">     ports:</span><br><span class="line">       - &quot;82:80&quot;</span><br><span class="line">     restart: always</span><br><span class="line">     environment:</span><br><span class="line">       WORDPRESS_DB_HOST: mysql:3306</span><br><span class="line">       WORDPRESS_DB_USER: wordpress</span><br><span class="line">       WORDPRESS_DB_PASSWORD: wordpress</span><br><span class="line">       WORDPRESS_DB_NAME: wordpress</span><br></pre></td></tr></table></figure>

<p>开始部署</p>
<p><code>docker-compose up -d</code></p>
<p>查看是否部署成功</p>
<p><code>docker ps</code></p>
<p>打开浏览器访问192.168.20.132:82</p>
<p>【题目4】容器基础操作</p>
<p>在master节点上停止并删除上述部署的wordpress容器。完成后提交master节点的用户名、密码和IP到答题框。</p>
<p>docker-compose down</p>
<p>【任务6】基于Docker容器的web应用系统部署[15分]</p>
<p>将该公司开发的基于微服务架构的web商城应用系统实现全容器化部署。商城应用系统架构图如下：</p>
<img src="/2022/07/01/2022%E6%B5%99%E6%B1%9F%E7%9C%81%E4%BA%91%E8%AE%A1%E7%AE%97%E6%A0%B7%E9%A2%98/clip_image002.gif" class="" title="img">

<table>
<thead>
<tr>
<th>模块</th>
<th>使用技术</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>gpmall.sql</td>
<td>Mysql</td>
<td>网站的数据库</td>
</tr>
<tr>
<td>dist目录</td>
<td>Nginx</td>
<td>网站的前端项目</td>
</tr>
<tr>
<td>gpmall-shopping</td>
<td>web项目</td>
<td>8081端口，商品&#x2F;购物车&#x2F;首页渲染等交互</td>
</tr>
<tr>
<td>gpmall-user</td>
<td>8082端口，提供用户相关的交互，如登录、注册、个人中心等</td>
<td></td>
</tr>
<tr>
<td>user-provider</td>
<td>后端服务</td>
<td>提供用户相关服务</td>
</tr>
<tr>
<td>shopping-provider</td>
<td>提供购物车、推荐商品、商品等服务</td>
<td></td>
</tr>
</tbody></table>
<p>【适用平台】私有云</p>
<p>【题目1】容器化部署Redis</p>
<p>在master节点上编写&#x2F;root&#x2F;redis&#x2F;Dockerfile文件，基于提供的软件包gpmall-single.tar构建chinaskill-redis:v1.1镜像，具体要求如下：</p>
<p>（1）基础镜像：centos:centos7.5.1804；</p>
<p>（2）作者：Chinaskill；</p>
<p>（3）修改配置文件中的bind 127.0.0.1为bind 0.0.0.0；</p>
<p>（4）设置Redis免密，并关闭保护模式；</p>
<p>（5）开放端口：6379；</p>
<p>（6）设置服务开机自启。</p>
<p>完成后构建镜像，并提交master节点的用户名、密码和IP到答题框。</p>
<p><code>vi Dockerfile</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">FROM centos:centos7.5.1804</span><br><span class="line">MAINTAINER Chinaskill</span><br><span class="line">RUN rm -rf /etc/yum.repos.d/*</span><br><span class="line">ADD local.repo /etc/yum.repos.d/</span><br><span class="line">RUN yum -y install redis</span><br><span class="line">RUN sed -i &#x27;s/bind 127.0.0.1/bind 0.0.0.0/g&#x27; /etc/redis.conf &amp;&amp; sed -i &#x27;s/protected-mode yes/protected-mode no/g&#x27; /etc/redis.conf</span><br><span class="line">EXPOSE 6379</span><br><span class="line">CMD [&quot;redis-server&quot;,&quot;/etc/redis.conf&quot;]</span><br></pre></td></tr></table></figure>

<p><code>vi local.repo</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[docker]</span><br><span class="line">baseurl=http://172.19.25.11/paas/kubernetes-repo/</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">[centos]</span><br><span class="line">baseurl=ftp://192.168.20.132/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br></pre></td></tr></table></figure>

<p><code>docker build -t chinaskill-redis:v1.1 .</code></p>
<p>【题目2】容器化部署MariaDB</p>
<p>在master节点上编写&#x2F;root&#x2F;mariadb&#x2F;Dockerfile文件，基于提供的软件包gpmall-single.tar构建chinaskill-mariadb:v1.1镜像，具体要求如下：</p>
<p>（1）基础镜像：centos:centos7.5.1804；</p>
<p>（2）作者：Chinaskill；</p>
<p>（3）设置数据库密码：123456；</p>
<p>（4）创建数据库gpmall并导入数据库文件gpmall.sql；</p>
<p>（5）设置字符编码：UTF-8；</p>
<p>（6）开放端口：3306；</p>
<p>（7）设置服务开机自启。</p>
<p>完成后构建镜像，并提交master节点的用户名、密码和IP到答题框。</p>
<p><code>vi Dockerfile</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">FROM centos:centos7.5.1804</span><br><span class="line">MAINTAINER chinaskill</span><br><span class="line">RUN rm -rf /etc/yum.repos.d/*</span><br><span class="line">ADD local.repo /etc/yum.repos.d/</span><br><span class="line">ADD gpmall.sql /opt/</span><br><span class="line">ADD start.sh /opt/</span><br><span class="line">RUN yum -y install mariadb-server \</span><br><span class="line">&amp;&amp; chmod +x /opt/start.sh \</span><br><span class="line">&amp;&amp; /opt/start.sh</span><br><span class="line">EXPOSE 3306</span><br><span class="line">ENV LC_ALL en_US.UTF-8</span><br><span class="line">CMD mysqld_safe</span><br></pre></td></tr></table></figure>

<p><code>cp /root/redis/local.repo /root/mariadb/</code></p>
<p><code>cp /opt/ChinaskillMall/gpmall.sql /root/mariadb/</code></p>
<p><code>vi start.sh</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">mysql_install_db --user=mysql</span><br><span class="line">mysqld_safe &amp;</span><br><span class="line">sleep 3</span><br><span class="line">mysqladmin -u root password &#x27;123456&#x27;</span><br><span class="line">mysql -uroot -p123456 -e &quot;grant all privileges on *.* to &#x27;root&#x27;@&#x27;%&#x27; identified by &#x27;123456&#x27;;&quot;</span><br><span class="line">mysql -uroot -p123456 -e &quot;create database gpmall;use gpmall;source /opt/gpmall.sql;&quot;</span><br></pre></td></tr></table></figure>

<p><code>docker build -t chinaskill-mariadb:v1.1 .</code></p>
<p>【题目3】容器化部署Zookeeper</p>
<p>在master节点上编写&#x2F;root&#x2F;zookeeper&#x2F;Dockerfile文件，基于提供的软件包gpmall-single.tar构建chinaskill-zookeeper:v1.1镜像，具体要求如下：</p>
<p>（1）基础镜像：centos:centos7.5.1804；</p>
<p>（2）作者：Chinaskill；</p>
<p>（3）开放端口：2181；</p>
<p>（4）设置服务开机自启。</p>
<p>完成后构建镜像，使用构建的镜像运行容器myzookeeper，并提交master节点的用户名、密码和IP到答题框。</p>
<p><code>vi Dockerfile</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FROM centos:centos7.5.1804</span><br><span class="line">MAINTAINER Chinaskill</span><br><span class="line">EXPOSE 2181</span><br><span class="line">RUN rm -rf /etc/yum.repos.d/*</span><br><span class="line">ADD local.repo /etc/yum.repos.d/ftp.repo</span><br><span class="line">ADD zookeeper-3.4.14.tar.gz /opt</span><br><span class="line">RUN yum -y install java-1.8.0-openjdk java-1.8.0-openjdk-devel \</span><br><span class="line">&amp;&amp; mv /opt/zookeeper-3.4.14/conf/zoo_sample.cfg /opt/zookeeper-3.4.14/conf/zoo.cfg</span><br><span class="line">CMD [&quot;sh&quot;,&quot;-c&quot;,&quot;/opt/zookeeper-3.4.14/bin/zkServer.sh start &amp;&amp; tail -f /etc/shadow&quot;]</span><br></pre></td></tr></table></figure>

<p><code>cp /opt/ChinaskillMall/zookeeper-3.4.14.tar.gz /root/zookeeper/</code></p>
<p><code>docker build -t chinaskill-zookeeper:v1.1 .</code></p>
<p>【题目4】容器化部署Kafka</p>
<p>在master节点上编写&#x2F;root&#x2F;kafka&#x2F;Dockerfile文件，基于提供的软件包gpmall-single.tar构建chinaskill-kafka:v1.1镜像，具体要求如下：</p>
<p>（1）基础镜像：centos:centos7.5.1804；</p>
<p>（2）作者：Chinaskill；</p>
<p>（3）开放端口：9092；</p>
<p>（4）设置服务开机自启。</p>
<p>完成后构建镜像，并提交master节点的用户名、密码和IP到答题框。</p>
<p><code>vi Dockerfile</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">FROM centos:centos7.5.1804</span><br><span class="line">MAINTAINER Chinaskill</span><br><span class="line">RUN rm -rf /etc/yum.repos.d/*</span><br><span class="line">ADD local.repo /etc/yum.repos.d/</span><br><span class="line">ADD zookeeper-3.4.14.tar.gz /opt</span><br><span class="line">ADD kafka_2.11-1.1.1.tgz /opt</span><br><span class="line">RUN yum install -y java-1.8.0-openjdk java-1.8.0-openjdk-devel \</span><br><span class="line"> &amp;&amp; mv /opt/zookeeper-3.4.14/conf/zoo_sample.cfg /opt/zookeeper-3.4.14/conf/zoo.cfg</span><br><span class="line">EXPOSE 9092</span><br><span class="line">CMD [&quot;sh&quot;,&quot;-c&quot;,&quot;/opt/zookeeper-3.4.14/bin/zkServer.sh start &amp;&amp; /opt/kafka_2.11-1.1.1/bin/kafka-server-start.sh /opt/kafka_2.11-1.1.1/config/server.properties&quot;]</span><br></pre></td></tr></table></figure>

<p><code>cp /opt/ChinaskillMall/kafka_2.11-1.1.1.tgz /root/kafka/</code></p>
<p><code>cp /opt/ChinaskillMall/zookeeper-3.4.14.tar.gz /root/kafka/</code></p>
<p><code>cp /root/redis/local.repo /root/kafka</code></p>
<p><code>docker build -t chinaskill-kafka:v1.1 .</code></p>
<p>【题目5】容器化部署Nginx</p>
<p>在master节点上编写&#x2F;root&#x2F;nginx&#x2F;Dockerfile文件，基于提供的软件包gpmall-single.tar构建chinaskill-nginx:v1.1镜像，具体要求如下：</p>
<p>（1）基础镜像：centos:centos7.5.1804；</p>
<p>（2）作者：Chinaskill；</p>
<p>（3）编写&#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;default.conf文件，配置反向代理，将80端口请求转发到8081、8082和8083；</p>
<p>（4）将dist.tar解压并复制到&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;目录下；</p>
<p>（5）开放端口：80、443、8081、8082、8083；</p>
<p>（6）设置服务开机自启。</p>
<p>完成后构建镜像，并提交master节点的用户名、密码和IP到答题框。</p>
<p><code>vi Dockerfile</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">FROM centos:centos7.5.1804</span><br><span class="line">MAINTAINER Chinaskill</span><br><span class="line">RUN rm -rf /etc/yum.repos.d/*</span><br><span class="line">ADD local.repo /etc/yum.repos.d/</span><br><span class="line">ADD *.jar /root/</span><br><span class="line">ADD setup.sh /root/</span><br><span class="line">RUN yum install -y nginx java-1.8.0-openjdk java-1.8.0-openjdk-devel </span><br><span class="line">RUN sed -i &#x27;1a location /shopping &#123; proxy_pass http://127.0.0.1:8081; &#125;&#x27; /etc/nginx/conf.d/default.conf </span><br><span class="line">RUN sed -i &#x27;2a location /user &#123; proxy_pass http://127.0.0.1:8082; &#125;&#x27; /etc/nginx/conf.d/default.conf </span><br><span class="line">RUN sed -i &#x27;3a location /casher &#123; proxy_pass http://127.0.0.1:8083; &#125;&#x27; /etc/nginx/conf.d/default.conf </span><br><span class="line">RUN chmod +x /root/setup.sh </span><br><span class="line">RUN rm -rf /usr/share/nginx/html/</span><br><span class="line">EXPOSE 80 443 8081 8082 8083 </span><br><span class="line">ADD dist/ /usr/share/nginx/html/</span><br><span class="line">CMD [&quot;nginx&quot;,&quot;-g&quot;,&quot;daemon off;&quot;]</span><br></pre></td></tr></table></figure>

<p><code>vi local.repo</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[centos]</span><br><span class="line">baseurl=ftp://192.168.20.132/centos</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">[docker]</span><br><span class="line">baseurl=ftp://192.168.20.132/kubernetes-repo</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">[gpmal]</span><br><span class="line">baseurl=http://172.19.25.11/paas/ChinaskillMall/gpmall-repo</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br></pre></td></tr></table></figure>

<p><code>cp /opt/ChinaskillMall/*.jar /root/nginx/</code></p>
<p><code>cp /opt/ChinaskillMall/dist/ /root/nginx/</code></p>
<p><code>vi setup.sh</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">nohup java -jar /root/shopping-provider-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line">sleep 5</span><br><span class="line">nohup java -jar /root/user-provider-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line">sleep 5</span><br><span class="line">nohup java -jar /root/gpmall-shopping-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line">sleep 5</span><br><span class="line">nohup java -jar /root/gpmall-user-0.0.1-SNAPSHOT.jar &amp;</span><br><span class="line">sleep 5</span><br></pre></td></tr></table></figure>

<p><code>docker build -t chinaskill-nginx:v1.1 .</code></p>
<p>【题目6】编排部署GPMall商城</p>
<p>在master节点上编写&#x2F;root&#x2F;chinaskillmall&#x2F;docker-compose.yaml文件，具体要求如下：</p>
<p>（1）容器1名称：mysql；镜像：chinaskill-mariadb:v1.1；端口映射：3306:3306；</p>
<p>（2）容器2名称：redis；镜像：chinaskill-redis:v1.1；端口映射：6379:6379；</p>
<p>（3）容器3名称：kafka；镜像：chinaskill-kafka:v1.1；端口映射：9092:9092；</p>
<p>（4）容器4名称：zookeeper；镜像：chinaskill-zookeeper:v1.1；端口映射：2181:2181；</p>
<p>（5）容器5名称：nginx；镜像：chinaskill-nginx:v1.1；端口映射：80:80，443:443。</p>
<p>完成后编排部署GPMall，并提交master节点的用户名、密码和IP到答题框。</p>
<p><code>vi docker-compose.yaml</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">version: &#x27;3.3&#x27;</span><br><span class="line">services:</span><br><span class="line">  mall-mysql:</span><br><span class="line">    image: chinaskill-mariadb:v1.1</span><br><span class="line">    ports:</span><br><span class="line">      - 3306:3306</span><br><span class="line"></span><br><span class="line">  mall-redis:</span><br><span class="line">    image: chinaskill-redis:v1.1</span><br><span class="line">    ports:</span><br><span class="line">      - 6379:6379</span><br><span class="line"></span><br><span class="line">  mall-kafka:</span><br><span class="line">    image: chinaskill-kafka:v1.1</span><br><span class="line">    ports:</span><br><span class="line">      - 9092:9092</span><br><span class="line"></span><br><span class="line">  mall-zookeeper:</span><br><span class="line">    image: chinaskill-zookeeper:v1.1</span><br><span class="line">    ports:</span><br><span class="line">      - 2181:2181</span><br><span class="line"></span><br><span class="line">  mall-nginx:</span><br><span class="line">    image: chinaskill-nginx:v1.1</span><br><span class="line">    depends_on:</span><br><span class="line">      - mall-mysql</span><br><span class="line">      - mall-redis</span><br><span class="line">      - mall-zookeeper</span><br><span class="line">      - mall-kafka</span><br><span class="line">    links:</span><br><span class="line">      - mall-mysql:mysql.mall</span><br><span class="line">      - mall-redis:redis.mall</span><br><span class="line">      - mall-zookeeper:zookeeper.mall</span><br><span class="line">      - mall-kafka:kafka.mall</span><br><span class="line">    ports:</span><br><span class="line">      - 83:80</span><br><span class="line">      - 443:443</span><br><span class="line">    command: [&quot;sh&quot;,&quot;-c&quot;,&quot;/root/setup.sh &amp;&amp; nginx &amp;&amp; tail -f /etc/shadow&quot;]</span><br></pre></td></tr></table></figure>

<p><code>docker-compose up -d</code></p>
<p>查看是否开启成功</p>
<p><code>docker ps</code></p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/09/02/%E9%87%91%E7%A0%96%E5%9B%BD%E8%B5%9B%E6%A0%B7%E9%A2%98%E4%B8%80/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          金砖国赛样题
        
      </div>
    </a>
  
  
    <a href="/2022/06/30/pig-dockerfile/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">pig-dockerfile</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>






</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2023 Miss
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/preccrep/hexo-theme-jelly" target="_blank">Jelly</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




  </div>
</body>
</html>